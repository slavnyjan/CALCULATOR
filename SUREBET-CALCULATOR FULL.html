<!doctype html>
<html lang="sk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Surebet kalkulačka - multi-currency</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8;color-scheme:dark}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#071022 0%,#07172a 100%);margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;color:#e6eef6}
    .card{background:rgba(255,255,255,0.03);padding:18px;border-radius:12px;box-shadow:0 6px 24px rgba(2,6,23,0.6);width:980px;max-width:100%;position:relative}
    h1{margin:0 0 8px;font-size:18px}
    .row{display:flex;gap:12px;margin-top:10px}
    .col{flex:1}
    label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
    input[type="number"], select{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit}
    button{background:linear-gradient(90deg,var(--accent),#60a5fa);border:none;color:#012; padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}
    .result{margin-top:14px;background:rgba(255,255,255,0.02);padding:12px;border-radius:8px}
    .green{color:#a7f3d0;font-weight:600}
    .red{color:#fecaca;font-weight:600}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{padding:8px;text-align:left;border-bottom:1px dashed rgba(255,255,255,0.03)}
    .small{font-size:13px;color:var(--muted)}
    .footer{margin-top:12px;font-size:12px;color:var(--muted)}
    #arbWrap{position:absolute;top:14px;right:20px;display:flex;gap:10px;align-items:center}
    .badge{padding:4px 8px;border-radius:8px;background:rgba(255,255,255,0.06)}
    .fxRow{display:flex;gap:8px;margin-top:10px}
    .fxRow input{width:110px}
    @media(max-width:900px){.row{flex-direction:column}}
  </style>
</head>
<body>
  <div class="card">
    <h1>Surebet kalkulačka — multi-currency</h1>

    <div id="arbWrap">
      <div id="arbDisplay" class="badge">+0.00 %</div>
      <div id="roiDisplay" class="badge">ROI +0.00 %</div>
    </div>

    <div class="small">Stávky môžeš zadávať priamo v zvolenej mene (EUR, USD, CZK). Kalkulačka všetko preratá do EUR a vypočíta zisk správne.</div>

    <div class="row" style="margin-top:12px">
      <div class="col">
        <label for="market">Typ trhu</label>
        <select id="market"><option value="2">2 výsledky</option><option value="3">3 výsledky</option></select>
      </div>
      <div class="col">
        <label for="stake">Celková stávka (EUR) — target suma</label>
        <input id="stake" type="number" min="0" step="0.01" value="100">
      </div>
      <div class="col">
        <label for="rounding">Zaokrúhlenie (display)</label>
        <input id="rounding" type="number" min="0.01" step="0.01" value="0.01">
      </div>
    </div>

    <div class="fxRow">
      <label class="small">1 EUR = <input id="fx_usd" type="number" step="0.0001" value="1.1000"> USD</label>
      <label class="small">1 EUR = <input id="fx_czk" type="number" step="0.01" value="25.00"> CZK</label>
    </div>

    <div id="oddsArea" class="row"></div>

    <div class="row" style="margin-top:12px;align-items:center">
      <div><button id="calc">Vypočítať</button></div>
    </div>

    <div id="out" class="result" style="display:none">
      <div id="summary"></div>
      <table id="table"></table>
      <div class="footer">Stávky zadávaj v príslušnej mene. Kalkulačka ich vždy prepočíta do EUR podľa FX a zisk počíta správne.</div>
    </div>
  </div>

<script>
(function(){
  function qs(id){return document.getElementById(id)}
  function fmt(n,p=2){return Number(n).toFixed(p)}
  const fx = {EUR:1, USD:1.1, CZK:25}

  const marketEl=qs('market'),oddsArea=qs('oddsArea'),calcBtn=qs('calc'),out=qs('out'),table=qs('table'),summary=qs('summary'),arbDisplay=qs('arbDisplay'),roiDisplay=qs('roiDisplay')

  function updateFx(){fx.USD=parseFloat(qs('fx_usd').value)||1;fx.CZK=parseFloat(qs('fx_czk').value)||1}

  function renderOddsInputs(){
    const n=Number(marketEl.value);oddsArea.innerHTML=''
    for(let i=0;i<n;i++){
      const col=document.createElement('div');col.className='col'
      const label=document.createElement('label');label.textContent=n===2?(i===0?'Kurz - Výsledok A':'Kurz - Výsledok B'):(i===0?'Kurz - 1':i===1?'Kurz - X':'Kurz - 2')
      const input=document.createElement('input');input.type='number';input.step='0.01';input.min='1.01';input.value=n===2?(i===0?'2.10':'1.95'):(i===0?'2.50':i===1?'3.40':'2.80');input.id='odd_'+i
      col.appendChild(label);col.appendChild(input);oddsArea.appendChild(col)
    }
  }

  function recomputeDisplays(stakesEUR,odds){
    const stakeTotal=stakesEUR.reduce((a,b)=>a+b,0)
    const profits=stakesEUR.map((s,idx)=>(s*odds[idx])-stakeTotal)
    const returns=stakesEUR.map((s,idx)=>s*odds[idx])
    const minReturn=Math.min(...returns)
    const roi=((minReturn/stakeTotal)-1)*100
    roiDisplay.textContent='ROI '+(roi>=0?'+':'')+roi.toFixed(2)+' %'
    roiDisplay.className=(roi>=0?'green':'red')
    for(let k=0;k<odds.length;k++){
      const cell=qs('ret_'+k)
      if(cell){cell.innerText=fmt(profits[k],2)+' EUR';cell.className=profits[k]>=0?'green':'red'}
    }
  }

  function calculate(){
    updateFx()
    const n=Number(marketEl.value)
    const stakeEUR=parseFloat(qs('stake').value)||0
    const rounding=parseFloat(qs('rounding').value)||0.01
    const odds=[]
    for(let i=0;i<n;i++) odds.push(parseFloat(qs('odd_'+i).value))
    if(stakeEUR<=0){alert('Zadaj platnú celkovú stávku.');return}
    if(odds.some(o=>!isFinite(o)||o<=1)){alert('Kurzy musia byť >1');return}

    const inv=odds.map(o=>1/o)
    const sumInv=inv.reduce((a,b)=>a+b,0)
    const arbGap=(100/sumInv)-100
    arbDisplay.textContent=(arbGap>=0?'+':'')+arbGap.toFixed(2)+' %'
    arbDisplay.className=(arbGap>=0?'green':'red')

    const stakesExact=inv.map(i=>(stakeEUR*i)/sumInv)
    let stakes=stakesExact.map(s=>Math.round(s/rounding)*rounding)

    out.style.display='block'
    summary.innerHTML=`Suma inverzií: <strong>${sumInv.toFixed(6)}</strong>. Arb gap: <strong>${arbGap.toFixed(2)} %</strong>`

    let html='<thead><tr><th>Výsledok</th><th>Kurz</th><th>Stávka</th><th>Mena</th><th>Zadaná stávka</th><th>Zisk (EUR)</th></tr></thead><tbody>'
    for(let i=0;i<n;i++){
      const label=n===2?(i===0?'A':'B'):(i===0?'1':i===1?'X':'2')
      html+=`<tr>
        <td>${label}</td>
        <td>${fmt(odds[i],2)}</td>
        <td><input type="number" step="0.01" value="${fmt(stakes[i],2)}" data-idx="${i}" class="stakeInput"></td>
        <td><select data-idx="${i}" class="currencySel"><option>EUR</option><option>USD</option><option>CZK</option></select></td>
        <td id="stakeConv_${i}">${fmt(stakes[i],2)} EUR</td>
        <td id="ret_${i}">0.00 EUR</td>
      </tr>`
    }
    html+='</tbody>'
    table.innerHTML=html

    document.querySelectorAll('.stakeInput').forEach(inp=>{
      inp.addEventListener('input',()=>{
        const idx=parseInt(inp.dataset.idx)
        const raw=parseFloat(inp.value)||0
        const curSel=document.querySelector(`.currencySel[data-idx="${idx}"]`).value
        stakes[idx]=raw* (1/fx[curSel]) // prepočet do EUR
        qs('stakeConv_'+idx).innerText=fmt(raw,2)+' '+curSel
        recomputeDisplays(stakes,odds)
      })
    })

    document.querySelectorAll('.currencySel').forEach(sel=>{
      sel.addEventListener('change',()=>{
        const idx=parseInt(sel.dataset.idx)
        const raw=parseFloat(document.querySelector(`.stakeInput[data-idx="${idx}"]`).value)||0
        const cur=sel.value
        stakes[idx]=raw*(1/fx[cur])
        qs('stakeConv_'+idx).innerText=fmt(raw,2)+' '+cur
        recomputeDisplays(stakes,odds)
      })
    })

    recomputeDisplays(stakes,odds)
  }

  marketEl.addEventListener('change',()=>{renderOddsInputs();out.style.display='none'})
  calcBtn.addEventListener('click',calculate)
  renderOddsInputs()
})();
</script>
</body>
</html>
